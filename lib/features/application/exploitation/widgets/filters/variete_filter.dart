import 'package:dropdown_pro/dropdown.dart';
import 'package:dropdown_pro/dropdown_item.dart';
import 'package:flutter/material.dart';
import 'package:flutter_bloc/flutter_bloc.dart';

import '../../../../../core/data/model/ObjectBox/objectBoxModels.dart';
import '../../../../../core/res/constants.dart';
import '../../../variete/widgets/all_variete_widget/bloc/all_varietes_bloc.dart';
import '../exploitations_widget/bloc/exploitation_bloc.dart';

class VarieteFilter extends StatelessWidget {
  const VarieteFilter({super.key});

  @override
  Widget build(BuildContext context) {
    List<DropdownItem> itemVarietesList = [];
    String singleSelectedVarieteId = "";

    _onLoginButtonPressed() {
      BlocProvider.of<ExploitationBloc>(context).add(LoadExploitationEvent(
          compte: Constants.compte,
          listStringVarieteId: Constants.listStringVarieteId,
          listStringAnneeId: Constants.listStringAnneeId,
          listStringSaisonId: Constants.listStringSaisonId,
          opId: Constants.utilisateurObject['op_id'] ?? 0,
          listStringProducteurId: Constants.listStringProducteurId));
    }

/*
    return BlocBuilder<AllVarietesBloc, AllVarietesState>(
        builder: (context, stateVariete) {
      List<DropdownItem> list = [];

      list.add(DropdownItem(
          id: '',
          value: 'Choix Variété',
          data: VarieteObject(
            id: 0,
            name: '',
            surface_unite: '',
            quantite_unite: '',
            rendement_unite: 0,
            produitid: 0,
            produitname: '',
            filiereid: 0,
            filierename: '',
            familleemplacementid: 0,
            familleemplacementname: '',
          )));
      var mesVarietes = stateVariete.varietes;
      for (var element in mesVarietes) {
        print(element.name);
        list.add(DropdownItem(
            id: element.id.toString(),
            value:
                '${element.mxProduitObject.target!.name.toString().toUpperCase()} | ${element.name.toString().toUpperCase()}',
            data: MxVarieteObject(
                id: element.id,
                name: element.name,
                surface_unite: element.surface_unite,
                quantite_unite: element.quantite_unite,
                rendement_unite: element.rendement_unite,
                isActive: element.isActive)));
      }

      itemVarietesList = list;

      return Column(
        children: [
          Dropdown.singleSelection(
              title: "CHOISIR UNE VARIETE",
              labelText: "VARIETE",
              hintText: "Selection variete",
              list: itemVarietesList,
              selectedId: singleSelectedVarieteId,
              onSingleItemListener: (selectedItem) {
                Constants.singleSelectedVarieteId = selectedItem.id;
                String itemId = selectedItem.id;
                String itemName = selectedItem.value;
                VarieteObject varieteObject =
                    selectedItem.data as VarieteObject;
                _onLoginButtonPressed();
                print(
                    "Item Id: $itemId -- Item Name: $itemName ## Other Details ## Variete Id: ${varieteObject.id} -- Variete valeur: ${varieteObject.produitname}");
              }),
        ],
      );
    });
  */
    return Container();
  }
}
